<!doctype html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta http-equiv="content-style-type" content="text/css" />
	<title>Browser Access demonstration</title>
	<script type="text/javascript" src="scripts/browser_access_library.js"></script>
	<script type="text/javascript">
		BrowserAccess.init();
		
		var app = new Application(function(request, response) {
			response.bodyText = 'Demo site default response';
			response.setHeader('Content-Length', response.bodyText.
					length, false);
			response.send();
		});
		
		BrowserAccess.registerApplication('app')

		function $(id) {
			return document.getElementById(id);
		}

		function updateServerStatus() {
			$('serverStatus').innerHTML = BrowserAccess.type;
		}
		
		function addResource(path, resource) {
			var url = app.addResource(path, resource);
			$('serverStatus').innerHTML += '<br />' + ((url != null) ?
					('Resource successfully added! link: '
					+ '<a href=\'' + url + '\'>' + url + '</a>') :
					'Resource failed to add...');
		}
		
		function registerApplication(appName) {
			var url = BrowserAccess.registerApplication(appName, app);
			$('serverStatus').innerHTML += '<br />' + ((url != null) ?
					('Application successfully registered! link: '
					+ '<a href=\'' + url + '\'>' + url + '</a>') :
					'Application failed to register...');
		}
	</script>
	<style>
		div {
			border-width: 1px;
			border-style: solid;
			border-color: black;
			margin: 10px;
		}
		textarea {
			width: 600px;
			height: 100px;
		}
	</style>
</head>
<body onload="updateServerStatus();">
	<div id="serverInfo">
		<div id="serverStatus"></div>
		<div id="serverHostProcedure">
			Application Name:<input type="text" id="appName" value="app" />
			<button onclick="registerApplication($('appName').value)">Register Application</button><br />
			Resource name:<input type="text" id="resourceName" value="resource" /><br />
			code:<br/>
			function handler(request, response) {<br />
			<textarea id="procedure">
$("serverStatus").innerHTML += "<br />Received request of method <b>" + request.method + "</b> on url <b>" + request.url + ", queryString = " + request.queryString + "</b>";
$("serverStatus").innerHTML += "<br /> Request sender agent: <b>" + request.headers["user-agent"] + "</b>";
$("serverStatus").innerHTML += "<br /> Request body: <b>" + request.bodyText + "</b>";
response.bodyText = "This is some response text...";
response.headers["SomeHeader"] = "SomeValue";
response.send();
			</textarea><br />}<br />
			<button onclick="addResource($('resourceName').value, 
					new Function('request', 'response', $('procedure').
					value))">Add Resource</button>
		</div>
	</div>
</body>
</html>
